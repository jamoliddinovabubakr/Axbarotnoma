{% load menu_tag %}
{% get_sub_menus as sub_menus %}
{% with request.resolver_match.url_name as url_name %}
    <ul class="nav">
        <li class="nav-header">Shaxsiy Kabinet</li>
        {% for menu in allow_menus %}
            {% if menu.type_menu == 0 %}
                <li class="{% if url_name == menu.url %} active {% endif %}">
                    <a href="{{ menu.get_absolute_url }}">
                        <i class="material-icons">{{ menu.icon }}</i>
                        <span>{{ menu.name }}</span>
                    </a>
                </li>
            {% endif %}
            {% if menu.type_menu == 1 %}
                <li class="has-sub">
                    <a href="javascript:;">
                        <b class="caret"></b>
                        <i class="material-icons">{{ menu.icon }}</i>
                        <span>{{ menu.name }}</span>
                    </a>
                    <ul class="sub-menu">
                        {% for item in sub_menus %}
                            {% if item.type_menu == 2 and item.parent_id == menu.id %}
                                <li class="{% if url_name == item.url %} active {% endif %}">
                                    <a href="{{ item.get_absolute_url }}">{{ item.name }}</a>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </li>
            {% endif %}
        {% endfor %}
    </ul>
{% endwith %}